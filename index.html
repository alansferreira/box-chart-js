<html>
    <head>
    </head>
    <body>
        <div id="myCanvas" style="width: 100%; height: 100%">
        </div>

        <script src="bower/jquery/dist/jquery.min.js"></script>
        <script src="bower/javascript-detect-element-resize/jquery.resize.js"></script>
        <script src="bower/konva/konva.min.js"></script>

        <script type="text/javascript" src="five-box-chart.js"></script>
        <script type="text/javascript" canvas="myCanvas">
            var options = {
                container: '#myCanvas', 
                xAxis: {
                    title: 'title X axis here',
                    rule:{
                        start: 0.0, 
                        end: 1.0,
                        step: 0.1
                    }
                }, 
                yAxis: {
                    title: 'title Y axis here',
                    rule:{
                        start: 0, 
                        end: 140,
                        step: 10
                    }
                }, 
                data: [
                    {id: 0, x: 1, y: 1, title: null}
                ],
                boxes: [
                    {x: 0, y: 0, w: 0.6, h: 90, fill: '#FFFF7F', title: 'E', events:{mouseenter: showInside}}, 
                    {x: 0.6, y: 0, w: 1, h: 90, fill: '#FF7F7F', title: 'D', events:{mouseenter: showInside}}, 
                    {x: 0, y: 90, w: 0.6, h: 140, fill: '#F2F2F2', title: 'C', events:{mouseenter: showInside}}, 
                    {x: 0.6, y: 90, w: 1, h: 140, fill: '#7F7FFF', title: 'B', events:{mouseenter: showInside}}, 
                    {x: 0.9, y: 130, w: 1, h: 140, fill: '#7FBF7F', title: 'A', events:{mouseenter: showInside}}, 
                    //{x: 0, y: 0, w: 0.4, h: 60, fill: 'grey'}, 
                    //{x: 0.5, y: 0, w: 0.9, h: 60, fill: 'blue'}, 
                ], 
                grid: {
                    stroke:{x: '#C1C2C3', y: '#C1C2C3'}
                }
            };
            var _lastMouseBox = null;
            function showInside(evt){

                //alert(evt.currentTarget.data.title);
                var box = evt.currentTarget.data;
                if(_lastMouseBox==box) return;
                _lastMouseBox=box;

                for (var p = 0; p < plot.options.data.length; p++) {
                    var data = plot.options.data[p];
                    data.h = 1;
                    data.w = 1;
                    
                    if(isCollision(data, box)){
                        data.fill = 'pink';
                    }else{
                        data.fill = 'black'
                    }
                    
                }
                console.log('update');
                plot.update();
            }
            function randomData(){
                var data = [];
                var length = Math.floor(Math.random() * 2000);
                for(var i = 0; i < length; i++){
                    data.push({ 
                        x: Math.floor(Math.random() * 1000)/1000, 
                        y: Math.floor(Math.random() * 140), 
                        radius: 2, fill: 'black'
                    });
                }
                return data;
            }

            options.data = randomData();
            var plot = plotFiveBox(options);

            function isCollision(rect1, rect2){
                if (rect1.x > rect2.x && rect1.x < rect2.x + rect2.w &&
                    rect1.y > rect2.y && rect1.y < rect2.y + rect2.h) {
                    return true;
                }
                return false;
            }



        </script>
    </body>
</html>